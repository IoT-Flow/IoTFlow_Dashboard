# Device Group Filter - Architecture Diagram

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend (React)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Devices.js (Page Component)                 â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  State:                                                    â”‚  â”‚
â”‚  â”‚  â€¢ devices: Device[]                                       â”‚  â”‚
â”‚  â”‚  â€¢ groups: Group[]                                         â”‚  â”‚
â”‚  â”‚  â€¢ groupFilter: 'all' | number                            â”‚  â”‚
â”‚  â”‚  â€¢ deviceGroups: { [deviceId]: groupId[] }               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚         DeviceGroupFilter Component                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Props:                                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ groups: Group[]                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ selectedGroup: 'all' | number                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ onChange: (value) => void                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ loading: boolean                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Renders:                                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ MUI Select with FormControl                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ "All Groups" option                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ Group options with color indicators             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ Device counts per group                          â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                          â†“                                 â”‚  â”‚
â”‚  â”‚                    onChange callback                       â”‚  â”‚
â”‚  â”‚                          â†“                                 â”‚  â”‚
â”‚  â”‚              setGroupFilter(newValue)                      â”‚  â”‚
â”‚  â”‚                          â†“                                 â”‚  â”‚
â”‚  â”‚            filteredDevices recalculated                    â”‚  â”‚
â”‚  â”‚                          â†“                                 â”‚  â”‚
â”‚  â”‚              Device table re-renders                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚                             â†•                                     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              apiService.js (API Layer)                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Methods:                                                  â”‚  â”‚
â”‚  â”‚  â€¢ getGroups()                                             â”‚  â”‚
â”‚  â”‚  â€¢ createGroup(data)                                       â”‚  â”‚
â”‚  â”‚  â€¢ updateGroup(id, data)                                   â”‚  â”‚
â”‚  â”‚  â€¢ deleteGroup(id)                                         â”‚  â”‚
â”‚  â”‚  â€¢ getDevicesByGroup(id)                                   â”‚  â”‚
â”‚  â”‚  â€¢ addDeviceToGroup(groupId, deviceId)                    â”‚  â”‚
â”‚  â”‚  â€¢ removeDeviceFromGroup(groupId, deviceId)               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Features:                                                 â”‚  â”‚
â”‚  â”‚  â€¢ JWT authentication                                      â”‚  â”‚
â”‚  â”‚  â€¢ Error handling                                          â”‚  â”‚
â”‚  â”‚  â€¢ Request/Response interceptors                          â”‚  â”‚
â”‚  â”‚  â€¢ Toast notifications                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                            HTTP/HTTPS
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Backend (Node.js/Express)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              deviceGroupRoutes.js                         â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  POST   /api/groups                                        â”‚  â”‚
â”‚  â”‚  GET    /api/groups                                        â”‚  â”‚
â”‚  â”‚  GET    /api/groups/:id                                    â”‚  â”‚
â”‚  â”‚  PUT    /api/groups/:id                                    â”‚  â”‚
â”‚  â”‚  DELETE /api/groups/:id                                    â”‚  â”‚
â”‚  â”‚  POST   /api/groups/:id/devices                            â”‚  â”‚
â”‚  â”‚  DELETE /api/groups/:id/devices/:deviceId                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â†“                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         deviceGroupController.js                          â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Business Logic:                                           â”‚  â”‚
â”‚  â”‚  â€¢ User authorization                                      â”‚  â”‚
â”‚  â”‚  â€¢ Data validation                                         â”‚  â”‚
â”‚  â”‚  â€¢ Group CRUD operations                                   â”‚  â”‚
â”‚  â”‚  â€¢ Device association management                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â†“                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  Models (Sequelize)                        â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ Group model                                             â”‚  â”‚
â”‚  â”‚  â€¢ Device model                                            â”‚  â”‚
â”‚  â”‚  â€¢ DeviceGroupAssociation model                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                          SQL Queries
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Database (PostgreSQL)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Tables:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   groups     â”‚    â”‚ device_groups   â”‚    â”‚  devices   â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ id           â”‚â—„â”€â”€â”€â”¤ group_id        â”‚â”€â”€â”€â–ºâ”‚ id         â”‚     â”‚
â”‚  â”‚ name         â”‚    â”‚ device_id       â”‚    â”‚ name       â”‚     â”‚
â”‚  â”‚ description  â”‚    â”‚ created_at      â”‚    â”‚ type       â”‚     â”‚
â”‚  â”‚ color        â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ status     â”‚     â”‚
â”‚  â”‚ icon         â”‚                            â”‚ location   â”‚     â”‚
â”‚  â”‚ user_id      â”‚                            â”‚ user_id    â”‚     â”‚
â”‚  â”‚ created_at   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”‚ updated_at   â”‚                                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Flow Diagram

### Loading Groups (on Page Mount)

```
User Opens Devices Page
        â†“
  Devices.js mounts
        â†“
  useEffect triggers
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ apiService        â”‚
â”‚ .getGroups()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
    GET /api/groups
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend           â”‚
â”‚ Returns groups[]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
  setGroups(data)
          â†“
For each group:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ apiService             â”‚
  â”‚ .getDevicesByGroup(id) â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
    GET /api/groups/:id
             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Backend returns        â”‚
  â”‚ { devices: [...] }     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
  Build deviceGroups map
  { deviceId: [groupIds] }
             â†“
  setDeviceGroups(map)
             â†“
   Component Ready
```

### Filtering Devices (on Filter Change)

```
User Selects Group
        â†“
  onChange(groupId)
        â†“
  setGroupFilter(groupId)
        â†“
  React re-renders
        â†“
filteredDevices = devices.filter(device => {
  const matchesGroup = 
    groupFilter === 'all' || 
    deviceGroups[device.id]?.includes(groupFilter)
  return matchesGroup && otherFilters
})
        â†“
  Table updates with
  filtered devices
```

## ğŸ§ª Test Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Test Suite Structure                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  DeviceGroupFilter.test.js (Component Tests)        â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Rendering tests                                    â”‚   â”‚
â”‚  â”‚  â€¢ User interaction tests                             â”‚   â”‚
â”‚  â”‚  â€¢ State management tests                             â”‚   â”‚
â”‚  â”‚  â€¢ Loading/Disabled states                            â”‚   â”‚
â”‚  â”‚  â€¢ Accessibility tests                                â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  Mocks:                                               â”‚   â”‚
â”‚  â”‚  â€¢ window.matchMedia                                  â”‚   â”‚
â”‚  â”‚  â€¢ IntersectionObserver                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  apiService.groups.test.js (API Tests)               â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  â€¢ API method tests                                   â”‚   â”‚
â”‚  â”‚  â€¢ Request/Response validation                        â”‚   â”‚
â”‚  â”‚  â€¢ Error handling tests                               â”‚   â”‚
â”‚  â”‚  â€¢ Data transformation tests                          â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  Mocks:                                               â”‚   â”‚
â”‚  â”‚  â€¢ axios (with interceptors)                          â”‚   â”‚
â”‚  â”‚  â€¢ react-hot-toast                                    â”‚   â”‚
â”‚  â”‚  â€¢ localStorage                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  setupTests.js (Global Configuration)                â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Jest configuration                                 â”‚   â”‚
â”‚  â”‚  â€¢ Global mocks                                       â”‚   â”‚
â”‚  â”‚  â€¢ Test utilities                                     â”‚   â”‚
â”‚  â”‚  â€¢ Console warning filters                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ Component Hierarchy

```
Devices.js (Page)
â”‚
â”œâ”€â”€ Box (Header)
â”‚   â”œâ”€â”€ Typography (Page Title)
â”‚   â””â”€â”€ Button (Add Device)
â”‚
â”œâ”€â”€ Card (Filters)
â”‚   â””â”€â”€ CardContent
â”‚       â””â”€â”€ Grid (Container)
â”‚           â”œâ”€â”€ Grid item (Search)
â”‚           â”‚   â””â”€â”€ TextField
â”‚           â”œâ”€â”€ Grid item (Status Filter)
â”‚           â”‚   â””â”€â”€ Select
â”‚           â”œâ”€â”€ Grid item (Type Filter)
â”‚           â”‚   â””â”€â”€ Select
â”‚           â”œâ”€â”€ Grid item (Group Filter) â—„â”€â”€ NEW
â”‚           â”‚   â””â”€â”€ DeviceGroupFilter
â”‚           â”‚       â””â”€â”€ FormControl
â”‚           â”‚           â”œâ”€â”€ InputLabel
â”‚           â”‚           â””â”€â”€ Select
â”‚           â”‚               â”œâ”€â”€ MenuItem (All Groups)
â”‚           â”‚               â””â”€â”€ MenuItem[] (Groups)
â”‚           â”‚                   â”œâ”€â”€ Box (Color)
â”‚           â”‚                   â””â”€â”€ Text (Name + Count)
â”‚           â””â”€â”€ Grid item (Actions)
â”‚               â””â”€â”€ Buttons
â”‚
â””â”€â”€ Card (Device Table)
    â””â”€â”€ TableContainer
        â””â”€â”€ Table
            â”œâ”€â”€ TableHead
            â””â”€â”€ TableBody
                â””â”€â”€ TableRow[] (Filtered Devices)
```

## ğŸ” Security Flow

```
Frontend Request
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Request         â”‚
â”‚ Interceptor     â”‚ â† Add JWT token
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
   HTTP Request
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend         â”‚
â”‚ verifyToken     â”‚ â† Validate JWT
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Authorized?
    â”œâ”€ Yes â†’ Process Request
    â”‚          â†“
    â”‚    Check user_id
    â”‚          â†“
    â”‚    Query with user filter
    â”‚          â†“
    â”‚    Return filtered data
    â”‚
    â””â”€ No  â†’ 401 Unauthorized
              â†“
       Response Interceptor
              â†“
       handleUnauthorized()
              â†“
       Redirect to Login
```

## ğŸ“Š State Management Flow

```
Component State:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ devices: Device[]                â”‚ â† From getDevices()
â”‚ groups: Group[]                  â”‚ â† From getGroups()
â”‚ groupFilter: 'all' | number      â”‚ â† User selection
â”‚ deviceGroups: Map<id, groupIds>  â”‚ â† Computed from groups
â”‚ loading: boolean                 â”‚ â† Loading state
â”‚ groupsLoading: boolean           â”‚ â† Groups loading
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    State Changes
         â†“
   React Re-render
         â†“
 Derived State (Computed):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ filteredDevices = devices        â”‚
â”‚   .filter(matchesSearch)         â”‚
â”‚   .filter(matchesStatus)         â”‚
â”‚   .filter(matchesType)           â”‚
â”‚   .filter(matchesGroup) â—„â”€â”€ NEW  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Table Renders
```

---

**Legend:**
- â—„â”€â”€ NEW: Newly added functionality
- â†“: Data/Control flow
- â—„â”€â–º: Bidirectional relationship
- â”œâ”€â”€: Branch in flow
- â””â”€â”€: End of branch
